<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HSCode Search</title>
    <link rel="stylesheet" href="/css/search.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="HSCodeSearch-wrapper">

    <div class="HSCodeSearch-logo">
        <img src="/img/MainLogo.png" alt="logo">
    </div>


    <div class="HSCodeSearch-search-box">
        <div class="HS-input-wrapper">
            <input id="searchInput" type="text" placeholder="HSCode Search">
            <button id="clearBtn" class="clear-btn" style="display:none;">✕</button>
            <button id="searchBtn" class="search-btn" style="display:none;">Search</button>
        </div>
    </div>

    <div id="results" class="HSCodeSearch-results"></div>
</div>

<!-- 검색창 X,Search 버튼 스크립트-->
<script>
    const input = document.getElementById('searchInput');
    const clearBtn = document.getElementById('clearBtn');
    const searchBtn = document.getElementById('searchBtn');
    const resultsBox = document.getElementById('results');

    input.addEventListener('input', () => {
        if (input.value.trim() === "") {
            clearBtn.style.display = "none";
            searchBtn.style.display = "none";
            resultsBox.innerHTML = "";
        } else {
            clearBtn.style.display = "block";
            searchBtn.style.display = "block";
        }
    });

    clearBtn.addEventListener('click', () => {
        input.value = "";
        clearBtn.style.display = "none";
        searchBtn.style.display = "none";
        resultsBox.innerHTML = "";
        input.focus();
    });

    async function doSearch() {
        const keyword = input.value.trim();
        if (keyword === "") return;

        resultsBox.innerHTML = "<p>검색 중...</p>";

        const res = await fetch(`/api/search?q=${encodeURIComponent(keyword)}`);
        const data = await res.json();

        if (data.length === 0) {
            resultsBox.innerHTML = `<p>"${keyword}" 검색 결과 없음</p>`;
            return;
        }

        const html = data.map(item => `
            <div class="result-item">
                <div class="result-code">${item.code}</div>
                <div class="result-name">${item.name}</div>
                <div class="result-desc">${item.description}</div>
            </div>
        `).join("");

        resultsBox.innerHTML = html;
    }

    searchBtn.addEventListener('click', doSearch);

    input.addEventListener('keydown', (e) => {
        if (e.key === "Enter") doSearch();
    });
</script>


</body>
</html>